# Substance System Guide (Current)

## Overview
The substance system is **zero hardcoding** and driven entirely by JSON in the filesystem. A build-time script scans the data and generates a lazy-loaded catalog.

## Data Layout

```
src/data/substances/
├── compounds/
│   ├── pure/
│   │   └── water-h2o/
│   │       ├── info.json
│   │       ├── liquid/state.json
│   │       ├── solid/state.json
│   │       └── gas/state.json
│   └── solutions/
│       └── saltwater-3pct-nacl/
│           ├── info.json
│           └── liquid/state.json
└── periodic-table/
    ├── 001_H_nonmetal.json
    ├── 008_O_nonmetal.json
    └── ... 118 total
```

## Generated Catalog

```
src/generated/substanceCatalog.js   // Auto-generated on build/dev
```

Generated by:
```
scripts/generateSubstanceCatalog.js
```

## IDs & Naming

- Compounds use **simple IDs**: `water`, `ethanol`, `acetone`, `saltwater-3pct`
- Elements use **symbols**: `H`, `O`, `N`, `Cl`, `Ar`

## Loader API

```javascript
import {
  getAvailableSubstances,
  loadSubstance,
  loadSubstancePhase,
  loadSubstanceInfo,
  parseSubstanceProperties
} from '../utils/substanceLoader'

// Get IDs
const list = getAvailableSubstances()
// { compounds: [...], elements: [...], all: [...] }

// Load compound + phase state
const waterProps = await loadSubstancePhase('water', 'liquid')

// Load info only (no state files)
const oxygenInfo = await loadSubstanceInfo('O')

// Load raw data (compound or element)
const raw = await loadSubstance('ethanol', 'liquid')
const props = parseSubstanceProperties(raw)
```

## Phase State Files

Each compound has one or more phase state files:

```
{compound folder}/{phase}/state.json
```

Example:
```
water-h2o/liquid/state.json
```

## Adding a New Compound (Quick)

1. Create folder under `src/data/substances/compounds/pure/`
2. Add `info.json`
3. Add phase folders with `state.json`
4. Run `npm run dev` or `npm run build` to regenerate catalog

## Notes

- The catalog is **auto-generated**; never edit `src/generated/substanceCatalog.js` directly.
- All physics properties come from JSON. No in-code constants for substances.

---
**Last Updated:** January 29, 2026
